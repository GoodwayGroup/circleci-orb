description: Deploy an image to kubernetes

parameters:
  executor-name:
    type: enum
    default: "build-images"
    enum: ["build-images", "dockerhub-authed", "ecr-authed"]
  executor-tag:
    type: string
    default: eks-1.0.0
  kube-path:
    type: string
    default: .kube/
  environment:
    type: string
  notification-channel:
    type: string
    default:
  app-name:
    type: string
  wait-for-rollout:
    type: boolean
    default: false
  post-deploy-steps:
    type: steps
    default: []

executor:
  name: << parameters.executor-name >>
  tag: << parameters.executor-tag >>

steps:
  - deploy-to-kubernetes:
      kube-path: << parameters.kube-path >>
      environment: << parameters.environment >>
      notification-channel: << parameters.notification-channel >>
      app-name: << parameters.app-name >>
      wait-for-rollout: << parameters.wait-for-rollout >>
      post-deploy-steps: << parameters.post-deploy-steps >>
